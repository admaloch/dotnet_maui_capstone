<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="c971_project.Views.EditStudentPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:converters="clr-namespace:c971_project.Converters"
    Title="Edit Student"
    BackgroundColor="{StaticResource Cream}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:FirstErrorConverter x:Key="FirstErrorConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Label
                Margin="0,20,0,0"
                HorizontalOptions="Center"
                Style="{StaticResource HeaderLabel}"
                Text="Edit Student Information" />

            <!-- Student Info Form -->
            <Border
                Padding="20"
                BackgroundColor="{StaticResource White}"
                Stroke="{StaticResource Charcoal}"
                StrokeShape="RoundRectangle 12"
                StrokeThickness="2"
                Style="{StaticResource CardFrame}">

                <Border.Shadow>
                    <Shadow
                        Brush="{StaticResource DarkBlue}"
                        Opacity="0.2"
                        Radius="8"
                        Offset="0,4" />
                </Border.Shadow>

                <VerticalStackLayout Spacing="15">

                    <!-- Student ID -->
                    <VerticalStackLayout Spacing="5">
                        <Label Style="{StaticResource FieldLabel}" Text="Student ID" TextColor="{StaticResource DarkBlue}" />
                        <Entry
                            Placeholder="Enter student ID"
                            PlaceholderColor="{StaticResource LightBrown}"
                            Text="{Binding Student.StudentId, Mode=TwoWay}"
                            TextColor="{StaticResource DarkBlue}" />
                        <Label
                            Margin="5,0,0,0"
                            FontSize="12"
                            IsVisible="{Binding Student.HasErrors}"
                            Text="{Binding Student, Converter={StaticResource FirstErrorConverter}, ConverterParameter=StudentId}"
                            TextColor="Red" />
                    </VerticalStackLayout>

                    <!-- Full Name -->
                    <VerticalStackLayout Spacing="5">
                        <Label Style="{StaticResource FieldLabel}" Text="Full Name" TextColor="{StaticResource DarkBlue}" />
                        <Entry
                            Placeholder="Enter full name"
                            PlaceholderColor="{StaticResource LightBrown}"
                            Text="{Binding Student.Name, Mode=TwoWay}"
                            TextColor="{StaticResource DarkBlue}" />
                        <Label
                            Margin="5,0,0,0"
                            FontSize="12"
                            IsVisible="{Binding Student.HasErrors}"
                            Text="{Binding Student, Converter={StaticResource FirstErrorConverter}, ConverterParameter=Name}"
                            TextColor="Red" />
                    </VerticalStackLayout>

                    <!-- Email -->
                    <VerticalStackLayout Spacing="5">
                        <Label Style="{StaticResource FieldLabel}" Text="Email" TextColor="{StaticResource DarkBlue}" />
                        <Entry
                            Keyboard="Email"
                            Placeholder="Enter email address"
                            PlaceholderColor="{StaticResource LightBrown}"
                            Text="{Binding Student.Email, Mode=TwoWay}"
                            TextColor="{StaticResource DarkBlue}" />
                        <Label
                            Margin="5,0,0,0"
                            FontSize="12"
                            IsVisible="{Binding Student.HasErrors}"
                            Text="{Binding Student, Converter={StaticResource FirstErrorConverter}, ConverterParameter=Email}"
                            TextColor="Red" />
                    </VerticalStackLayout>

                    <!-- Status -->
                    <VerticalStackLayout Spacing="5">
                        <Label Style="{StaticResource FieldLabel}" Text="Status" TextColor="{StaticResource DarkBlue}" />
                        <Picker
                            Title="Select status"
                            ItemsSource="{Binding StatusOptions}"
                            SelectedItem="{Binding Student.Status, Mode=TwoWay}"
                            TextColor="{StaticResource DarkBlue}"
                            TitleColor="{StaticResource LightBrown}">
                            <Picker.BackgroundColor>
                                <OnPlatform x:TypeArguments="Color">
                                    <On Platform="iOS, Android" Value="Transparent" />
                                </OnPlatform>
                            </Picker.BackgroundColor>
                        </Picker>
                        <Label
                            Margin="5,0,0,0"
                            FontSize="12"
                            IsVisible="{Binding Student.HasErrors}"
                            Text="{Binding Student, Converter={StaticResource FirstErrorConverter}, ConverterParameter=Status}"
                            TextColor="Red" />
                    </VerticalStackLayout>

                    <!-- Major -->
                    <VerticalStackLayout Spacing="5">
                        <Label Style="{StaticResource FieldLabel}" Text="Major" TextColor="{StaticResource DarkBlue}" />
                        <Entry
                            Placeholder="Enter major"
                            PlaceholderColor="{StaticResource LightBrown}"
                            Text="{Binding Student.Major, Mode=TwoWay}"
                            TextColor="{StaticResource DarkBlue}" />
                        <Label
                            Margin="5,0,0,0"
                            FontSize="12"
                            IsVisible="{Binding Student.HasErrors}"
                            Text="{Binding Student, Converter={StaticResource FirstErrorConverter}, ConverterParameter=Major}"
                            TextColor="Red" />
                    </VerticalStackLayout>

                </VerticalStackLayout>
            </Border>

            <!-- Action Buttons -->
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="15">
                <Button Command="{Binding CancelCommand}" Style="{StaticResource SecondaryButton}" Text="Cancel" />
                <Button Command="{Binding SaveStudentCommand}" Style="{StaticResource PrimaryButton}" Text="Save Changes" />
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
